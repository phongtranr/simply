{{!-- Layout --}}
{{!< default}}

<header class="author-header">
    <div class="px-4 py-12 md:py-vw6 mx-auto max-w-3xl text-center">
        <h1 class="text-3xl md:text-4xl text-title">{{t "The full archive"}}</h1>
        <div class="mt-5 text-lg text-gray-500">{{t "There are {total} posts in total" total=pagination.total}}</div>
    </div>
</header>

<div class="site-post container mx-auto pb-10">
    <div class="feed-entry-wrap archive-feed max-w-3xl mx-auto">

        {{#foreach posts}}
        <article class="archive-post" data-year="{{date format="YYYY"}}" data-month="{{date format="MM"}}">
            <div class="archive-row">
                <div class="archive-year-cell">
                    <div class="archive-year-badge" data-archive-year-label>
                        <span class="archive-year-number">{{date format="YYYY"}}</span>
                        <span class="archive-year-caption">{{t "Thoughts"}}</span>
                    </div>
                </div>
                <div class="archive-entry">
                    <div class="archive-meta">
                        <span class="archive-month">{{date format="MMMM"}}</span>
                        <span class="archive-day">{{date format="DD MMM"}}</span>
                    </div>
                    <h2 class="archive-title"><a href="{{url}}">{{title}}</a></h2>
                </div>
            </div>
        </article>
        {{/foreach}}
    </div>
</div>

{{#contentFor "scripts"}}
<script>
    (function () {
        var wrapper = document.querySelector('.feed-entry-wrap')
        if (!wrapper) {
            return
        }
        var articles = Array.prototype.slice.call(wrapper.querySelectorAll('.archive-post[data-year][data-month]'))
        if (!articles.length) {
            return
        }
        var seenYears = Object.create(null)
        articles.forEach(function (article) {
            var year = article.getAttribute('data-year')
            if (!year) {
                return
            }
            var yearBadge = article.querySelector('[data-archive-year-label]')
            if (!seenYears[year]) {
                seenYears[year] = true
                article.id = 'year-' + year
                article.classList.add('archive-year-start')
            } else if (yearBadge && yearBadge.parentNode) {
                yearBadge.parentNode.removeChild(yearBadge)
            }
        })
    })()
</script>
{{/contentFor}}
