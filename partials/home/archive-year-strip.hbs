{{!-- Homepage archive navigation linking to yearly sections on the archive channel --}}
{{#if @custom.home_archive_strip}}
    {{#get "posts" limit="100" filter="tag:-[hash-portfolio,hash-kusi-doc,hash-podcast]" order="published_at desc" page="1" as |archive_posts_page_one|}}
        {{#if archive_posts_page_one}}
            <section class="home-archive-strip border-y border-gray-200 bg-rose-50/40">
                <div class="container mx-auto px-4 py-12">
                    <div class="max-w-4xl mx-auto flex flex-col items-center gap-8 text-center">
                        <h2 class="text-xs font-semibold uppercase tracking-[0.35em] text-gray-500">{{t "From the archive"}}</h2>
                        <nav class="archive-year-links w-full" aria-label="Archive years">
                            <ul class="archive-year-grid mx-auto grid w-full grid-cols-1 gap-3 sm:max-w-3xl sm:grid-cols-2 lg:max-w-none lg:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5">
                                {{#foreach archive_posts_page_one}}
                                    <li>
                                        <a class="flex h-16 w-full items-center justify-center rounded-md bg-dark-blue-500 px-6 text-lg font-semibold uppercase tracking-wide text-white transition hover:bg-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-dark" href="/archive/#year-{{date published_at format="YYYY"}}" data-year="{{date published_at format="YYYY"}}">{{date published_at format="YYYY"}}</a>
                                    </li>
                                {{/foreach}}
                                {{#get "posts" limit="100" filter="tag:-[hash-portfolio,hash-kusi-doc,hash-podcast]" order="published_at desc" page="2" as |archive_posts_page_two|}}
                                    {{#foreach archive_posts_page_two}}
                                        <li>
                                            <a class="flex h-16 w-full items-center justify-center rounded-md bg-dark-blue-500 px-6 text-lg font-semibold uppercase tracking-wide text-white transition hover:bg-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-dark" href="/archive/#year-{{date published_at format="YYYY"}}" data-year="{{date published_at format="YYYY"}}">{{date published_at format="YYYY"}}</a>
                                        </li>
                                    {{/foreach}}
                                {{/get}}
                                {{#get "posts" limit="100" filter="tag:-[hash-portfolio,hash-kusi-doc,hash-podcast]" order="published_at desc" page="3" as |archive_posts_page_three|}}
                                    {{#foreach archive_posts_page_three}}
                                        <li>
                                            <a class="flex h-16 w-full items-center justify-center rounded-md bg-dark-blue-500 px-6 text-lg font-semibold uppercase tracking-wide text-white transition hover:bg-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-dark" href="/archive/#year-{{date published_at format="YYYY"}}" data-year="{{date published_at format="YYYY"}}">{{date published_at format="YYYY"}}</a>
                                        </li>
                                    {{/foreach}}
                                {{/get}}
                                {{#get "posts" limit="100" filter="tag:-[hash-portfolio,hash-kusi-doc,hash-podcast]" order="published_at desc" page="4" as |archive_posts_page_four|}}
                                    {{#foreach archive_posts_page_four}}
                                        <li>
                                            <a class="flex h-16 w-full items-center justify-center rounded-md bg-dark-blue-500 px-6 text-lg font-semibold uppercase tracking-wide text-white transition hover:bg-dark focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-dark" href="/archive/#year-{{date published_at format="YYYY"}}" data-year="{{date published_at format="YYYY"}}">{{date published_at format="YYYY"}}</a>
                                        </li>
                                    {{/foreach}}
                                {{/get}}
                            </ul>
                        </nav>
                    </div>
                </div>
            </section>
            <script>
                (function () {
                    var script = document.currentScript
                    if (!script) {
                        return
                    }
                    var container = script.previousElementSibling
                    if (!container) {
                        return
                    }
                    var nav = container.querySelector('nav.archive-year-links')
                    if (!nav) {
                        return
                    }
                    var seenYears = []
                    Array.prototype.slice.call(nav.querySelectorAll('a[data-year]')).forEach(function (link) {
                        var year = link.getAttribute('data-year')
                        if (seenYears.indexOf(year) !== -1) {
                            var item = link.closest('li')
                            if (item && item.parentNode) {
                                item.parentNode.removeChild(item)
                            } else {
                                link.parentNode.removeChild(link)
                            }
                        } else {
                            seenYears.push(year)
                        }
                    })
                })()
            </script>
        {{/if}}
    {{/get}}
{{/if}}

